import React, { useState, useEffect } from 'react';
import {
  Droplets,
  Shield,
  Users,
  Target,
  Briefcase,
  Mail,
  ChevronDown,
  Phone,
  MapPin,
  Menu,
  X
} from 'lucide-react';

/**
 * AquaShieldWebsite.jsx
 * Versión mejorada del componente provisto:
 * - Navegación responsive con hamburger
 * - Indicador de sección activa
 * - Formulario de contacto con validación básica y simulación de envío
 * - Animaciones y mejoras de accesibilidad
 *
 * Requisitos:
 * - Tailwind CSS configurado en el proyecto
 * - lucide-react instalado (o sustituir íconos por otros)
 */

export default function AquaShieldWebsite() {
  const [activeSection, setActiveSection] = useState('inicio');
  const [menuOpen, setMenuOpen] = useState(false);
  const [form, setForm] = useState({ nombre: '', email: '', mensaje: '' });
  const [errors, setErrors] = useState({});
  const [enviando, setEnviando] = useState(false);
  const [enviadoOk, setEnviadoOk] = useState(false);

  useEffect(() => {
    const onScroll = () => {
      const secciones = ['inicio','servicios','propuesta','clientes','equipo','contacto'];
      for (const id of secciones) {
        const el = document.getElementById(id);
        if (!el) continue;
        const rect = el.getBoundingClientRect();
        if (rect.top <= 120 && rect.bottom >= 120) {
          setActiveSection(id);
          break;
        }
      }
    };
    window.addEventListener('scroll', onScroll, { passive: true });
    return () => window.removeEventListener('scroll', onScroll);
  }, []);

  const scrollToSection = (id) => {
    setMenuOpen(false);
    setActiveSection(id);
    document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' });
  };

  const validateForm = () => {
    const e = {};
    if (!form.nombre.trim()) e.nombre = 'Ingresa tu nombre';
    if (!form.email.trim()) e.email = 'Ingresa un correo válido';
    else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(form.email)) e.email = 'Formato de email inválido';
    if (!form.mensaje.trim()) e.mensaje = 'Escribe un mensaje';
    setErrors(e);
    return Object.keys(e).length === 0;
  };

  const handleSubmit = async (ev) => {
    ev?.preventDefault();
    if (!validateForm()) return;
    setEnviando(true);
    setEnviadoOk(false);
    // Simulamos un envío; reemplaza por llamada a API real
    await new Promise((r) => setTimeout(r, 1100));
    setEnviando(false);
    setEnviadoOk(true);
    setForm({ nombre: '', email: '', mensaje: '' });
    setTimeout(() => setEnviadoOk(false), 5000);
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-cyan-50 to-teal-50 text-gray-800">
      {/* Header/Navigation */}
      <nav className="fixed top-0 w-full bg-white/90 backdrop-blur-md shadow z-50">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-16">
            <div className="flex items-center space-x-3">
              <div className="flex items-center justify-center w-10 h-10 bg-gradient-to-br from-blue-600 to-cyan-500 rounded-full shadow">
                <Shield className="w-6 h-6 text-white" aria-hidden />
              </div>
              <button
                className="text-2xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-cyan-600"
                aria-label="AquaShield home"
                onClick={() => scrollToSection('inicio')}
              >
                AquaShield
              </button>
            </div>

            <div className="hidden md:flex items-center space-x-6">
              {['Inicio','Servicios','Propuesta','Clientes','Equipo','Contacto'].map((item) => {
                const id = item.toLowerCase();
                const isActive = activeSection === id;
                return (
                  <button
                    key={id}
                    onClick={() => scrollToSection(id)}
                    className={`font-medium transition-colors ${isActive ? 'text-blue-600 underline underline-offset-4' : 'text-gray-700 hover:text-blue-600'}`}
                    aria-current={isActive ? 'page' : undefined}
                  >
                    {item}
                  </button>
                );
              })}
              <button
                onClick={() => scrollToSection('contacto')}
                className="ml-2 inline-flex items-center gap-2 bg-gradient-to-r from-blue-600 to-cyan-600 text-white px-4 py-2 rounded-full shadow hover:scale-105 transform transition"
              >
                Solicitar Evaluación
              </button>
            </div>

            {/* Mobile menu button */}
            <div className="md:hidden">
              <button
                onClick={() => setMenuOpen(!menuOpen)}
                aria-label="Abrir menú"
                aria-expanded={menuOpen}
                className="p-2 rounded-md text-gray-700 hover:bg-gray-100"
              >
                {menuOpen ? <X className="w-6 h-6" /> : <Menu className="w-6 h-6" />}
              </button>
            </div>
          </div>
        </div>

        {/* Mobile menu */}
        {menuOpen && (
          <div className="md:hidden bg-white/95 border-t">
            <div className="px-4 pb-4 space-y-2">
              {['Inicio','Servicios','Propuesta','Clientes','Equipo','Contacto'].map((item) => (
                <button
                  key={item}
                  onClick={() => scrollToSection(item.toLowerCase())}
                  className="w-full text-left py-2 px-2 rounded-md hover:bg-gray-50"
                >
                  {item}
                </button>
              ))}
            </div>
          </div>
        )}
      </nav>

      {/* Hero Section */}
      <main>
        <section id="inicio" className="pt-28 pb-16 px-4 sm:px-6 lg:px-8">
          <div className="max-w-7xl mx-auto">
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
              <div>
                <div className="inline-block mb-5">
                  <div className="flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-full shadow-lg">
                    <Shield className="w-10 h-10 text-white" />
                  </div>
                </div>
                <h1 className="text-4xl md:text-5xl font-extrabold text-gray-900 leading-tight mb-4">
                  Transformando Inundaciones en
                  <span className="block bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent">
                    Oportunidades Sostenibles
                  </span>
                </h1>
                <p className="text-lg text-gray-600 mb-6 max-w-xl">
                  Protegemos tu hogar, institución o empresa mientras convertimos el agua estancada
                  en un recurso útil y económico para toda la comunidad.
                </p>
                <div className="flex flex-wrap gap-4">
                  <button
                    onClick={() => scrollToSection('contacto')}
                    className="bg-gradient-to-r from-blue-600 to-cyan-600 text-white px-6 py-3 rounded-full font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 transition"
                  >
                    Solicita Evaluación Gratuita
                  </button>
                  <button
                    onClick={() => scrollToSection('servicios')}
                    className="px-6 py-3 rounded-full border border-blue-200 text-blue-700 bg-white/60 hover:bg-white transition"
                  >
                    Conoce Nuestros Servicios
                  </button>
                </div>

                {/* Stats */}
                <div className="mt-10 grid grid-cols-1 sm:grid-cols-3 gap-4">
                  {[
                    { label: 'Prevención de Inundaciones', value: '100%', icon: Shield },
                    { label: 'Agua Reutilizada', value: 'Miles de Litros', icon: Droplets },
                    { label: 'Comunidades Impactadas', value: 'Múltiples', icon: Users }
                  ].map((stat, idx) => (
                    <div key={idx} className="bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition">
                      <div className="flex items-center gap-3">
                        <div className="w-10 h-10 rounded-lg flex items-center justify-center bg-gradient-to-br from-blue-500 to-cyan-500 text-white">
                          <stat.icon className="w-5 h-5" />
                        </div>
                        <div>
                          <div className="text-xl font-bold text-gray-900">{stat.value}</div>
                          <div className="text-sm text-gray-500">{stat.label}</div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* Hero image / placeholder */}
              <div className="order-first lg:order-last">
                <div className="w-full h-64 md:h-80 lg:h-96 rounded-3xl overflow-hidden shadow-xl bg-gradient-to-br from-cyan-50 to-blue-50 flex items-center justify-center">
                  {/* Aquí puedes reemplazar por una imagen real desde assets o URL */}
                  <div className="text-center px-6">
                    <Droplets className="w-20 h-20 text-blue-400 mx-auto mb-4" />
                    <p className="text-gray-600">Imagen representativa: recolección y tratamiento del agua</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        {/* Historia */}
        <section className="py-16 px-4 sm:px-6 lg:px-8 bg-white">
          <div className="max-w-7xl mx-auto">
            <h2 className="text-3xl md:text-4xl font-bold text-center mb-8 text-gray-900">Nuestra Historia</h2>
            <div className="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-3xl p-6 md:p-10">
              <p className="text-lg text-gray-700 leading-relaxed mb-4">
                AquaShield surge para transformar un problema recurrente (lluvias intensas, aguas estancadas y
                afectación a hogares e instituciones) en una oportunidad de salud pública y sostenibilidad.
              </p>
              <p className="text-lg text-gray-700 leading-relaxed">
                Integramos prevención de inundaciones, recolección y tratamiento de agua, y educación comunitaria.
                Hemos participado en iniciativas como Cartagena Ciudad Sostenible 2.0 y el Reto Incuba CUEE.
              </p>
            </div>
          </div>
        </section>

        {/* Servicios */}
        <section id="servicios" className="py-16 px-4 sm:px-6 lg:px-8">
          <div className="max-w-7xl mx-auto">
            <h2 className="text-3xl md:text-4xl font-bold text-center mb-4 text-gray-900">¿Qué Hacemos?</h2>
            <p className="text-center text-gray-600 mb-8 max-w-3xl mx-auto">
              Operamos un servicio integral de protección y gestión sostenible del agua
            </p>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {[
                {
                  title: 'Recolección de Agua',
                  description: 'Extraemos aguas estancadas con camiones especializados, reduciendo riesgos de inundación.',
                  gradient: 'from-blue-500 to-blue-600'
                },
                {
                  title: 'Tratamiento y Clasificación',
                  description: 'Procesamos y clasificamos el agua según su calidad para diferentes usos responsables.',
                  gradient: 'from-cyan-500 to-cyan-600'
                },
                {
                  title: 'Barreras Portátiles',
                  description: 'Comercializamos barreras contra inundaciones para proteger viviendas e instituciones.',
                  gradient: 'from-teal-500 to-teal-600'
                },
                {
                  title: 'Filtros Portátiles',
                  description: 'Ofrecemos filtros con carbón activado y membranas para emergencias o consumo seguro.',
                  gradient: 'from-blue-600 to-cyan-600'
                },
                {
                  title: 'Redistribución',
                  description: 'Suministramos agua clasificada a hogares, empresas e instituciones según calidad.',
                  gradient: 'from-cyan-600 to-teal-600'
                },
                {
                  title: 'Educación Comunitaria',
                  description: 'Capacitamos y dejamos habilidades instaladas en la comunidad para gestión sostenible.',
                  gradient: 'from-teal-600 to-blue-600'
                }
              ].map((service, idx) => (
                <article key={idx} className="bg-white rounded-2xl p-6 shadow hover:shadow-2xl transition transform hover:-translate-y-2">
                  <div className={`w-12 h-12 bg-gradient-to-br ${service.gradient} rounded-xl mb-4 flex items-center justify-center`}>
                    <Droplets className="w-6 h-6 text-white" />
                  </div>
                  <h3 className="text-xl font-semibold mb-2 text-gray-900">{service.title}</h3>
                  <p className="text-gray-600">{service.description}</p>
                </article>
              ))}
            </div>
          </div>
        </section>

        {/* Propuesta de Valor */}
        <section id="propuesta" className="py-16 px-4 sm:px-6 lg:px-8 bg-gradient-to-br from-blue-600 to-cyan-600 text-white">
          <div className="max-w-7xl mx-auto">
            <div className="text-center mb-8">
              <Target className="w-14 h-14 mx-auto mb-4" />
              <h2 className="text-3xl md:text-4xl font-bold mb-3">Nuestra Propuesta de Valor</h2>
              <p className="text-lg text-blue-100 max-w-3xl mx-auto">
                Reducir pérdidas por inundaciones, mejorar la salud y la resiliencia urbana,
                y facilitar el aprovechamiento sostenible del agua
              </p>
            </div>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              {[
                { title: 'Recolección', description: 'Capturamos aguas estancadas antes de que causen daños' },
                { title: 'Clasificación', description: 'Tratamos y categorizamos el agua según calidad y uso' },
                { title: 'Suministro', description: 'Redistribuimos para usos potables, domésticos o industriales' }
              ].map((item, idx) => (
                <div key={idx} className="bg-white/10 backdrop-blur-sm rounded-2xl p-6 hover:bg-white/20 transition">
                  <h3 className="text-2xl font-semibold mb-2">{item.title}</h3>
                  <p className="text-blue-100">{item.description}</p>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* Clientes */}
        <section id="clientes" className="py-16 px-4 sm:px-6 lg:px-8 bg-white">
          <div className="max-w-7xl mx-auto">
            <h2 className="text-3xl md:text-4xl font-bold text-center mb-4 text-gray-900">¿A Quién Servimos?</h2>
            <p className="text-center text-gray-600 mb-8 max-w-3xl mx-auto">
              Acompañamos a diversos sectores en su camino hacia la sostenibilidad y la prevención
            </p>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              {[
                { tipo: 'Hogares', descripcion: 'Especialmente en zonas en condiciones especiales que requieren protección contra inundaciones' },
                { tipo: 'Instituciones Educativas', descripcion: 'Colegios, universidades y centros educativos que buscan sostenibilidad' },
                { tipo: 'Sector Salud', descripcion: 'Hospitales y centros médicos que necesitan continuidad operativa' },
                { tipo: 'Empresas', descripcion: 'Hoteles, constructoras, industrias y centros comerciales' },
                { tipo: 'Gobiernos Locales', descripcion: 'Entidades públicas con programas de agua segura y gestión del riesgo' },
                { tipo: 'ONGs', descripcion: 'Organizaciones con proyectos de impacto social y ambiental' }
              ].map((cliente, idx) => (
                <div key={idx} className="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl p-6 border-l-4 border-blue-600 hover:shadow-lg transition">
                  <h3 className="text-xl font-semibold text-gray-900 mb-2">{cliente.tipo}</h3>
                  <p className="text-gray-600">{cliente.descripcion}</p>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* Proceso */}
        <section className="py-16 px-4 sm:px-6 lg:px-8">
          <div className="max-w-7xl mx-auto">
            <h2 className="text-3xl md:text-4xl font-bold text-center mb-4 text-gray-900">Cómo Trabajamos</h2>
            <p className="text-center text-gray-600 mb-8 max-w-3xl mx-auto">
              Un proceso integral basado en datos para garantizar calidad y trazabilidad
            </p>
            <div className="space-y-6">
              {[
                { paso: '1', titulo: 'Diagnóstico y Planificación', descripcion: 'Análisis técnico y ruta de intervención' },
                { paso: '2', titulo: 'Succión y Transporte', descripcion: 'Recolección con equipos especializados' },
                { paso: '3', titulo: 'Tratamiento', descripcion: 'Filtrado, desinfección y clasificación' },
                { paso: '4', titulo: 'Almacenamiento', descripcion: 'Tanques compartimentados y logística' },
                { paso: '5', titulo: 'Entrega y Capacitación', descripcion: 'Suministro y formación a la comunidad' }
              ].map((p, idx) => (
                <div key={idx} className="flex items-start space-x-4">
                  <div className="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-blue-600 to-cyan-600 rounded-full flex items-center justify-center text-white font-bold text-lg">
                    {p.paso}
                  </div>
                  <div className="flex-1 bg-white rounded-xl p-4 shadow">
                    <h3 className="font-semibold text-gray-900">{p.titulo}</h3>
                    <p className="text-gray-600">{p.descripcion}</p>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* Aliados */}
        <section className="py-16 px-4 sm:px-6 lg:px-8 bg-white">
          <div className="max-w-7xl mx-auto">
            <h2 className="text-3xl md:text-4xl font-bold text-center mb-4 text-gray-900">Socios y Aliados</h2>
            <p className="text-center text-gray-600 mb-8 max-w-3xl mx-auto">
              Trabajamos con organizaciones clave para garantizar calidad y expansión regional
            </p>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              {[
                { tipo: 'Universidades y Centros de Investigación', rol: 'Validan impactos y aceleran el desarrollo tecnológico' },
                { tipo: 'Instituciones Educativas', rol: 'Sensibilización y formación comunitaria' },
                { tipo: 'Fabricantes de Sensores y Tanques', rol: 'Garantizan fiabilidad operativa del sistema' },
                { tipo: 'Sector Logístico y Entidades Públicas', rol: 'Escalan cobertura y capacidad de respuesta' }
              ].map((aliado, idx) => (
                <div key={idx} className="bg-gradient-to-br from-cyan-50 to-teal-50 rounded-xl p-6 hover:shadow-lg transition">
                  <Briefcase className="w-7 h-7 text-blue-600 mb-2" />
                  <h3 className="text-xl font-semibold text-gray-900 mb-1">{aliado.tipo}</h3>
                  <p className="text-gray-600">{aliado.rol}</p>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* Equipo */}
        <section id="equipo" className="py-16 px-4 sm:px-6 lg:px-8">
          <div className="max-w-7xl mx-auto">
            <div className="text-center mb-8">
              <Users className="w-14 h-14 mx-auto mb-4 text-blue-600" />
              <h2 className="text-3xl md:text-4xl font-bold mb-2 text-gray-900">Nuestro Equipo</h2>
              <p className="text-gray-600 max-w-3xl mx-auto">Equipo multidisciplinario: ingeniería, operación y educación comunitaria</p>
            </div>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {[
                { nombre: 'Vanessa Sofía Diago Rodríguez', rol: 'Ingeniería y Optimización del Proyecto', descripcion: 'Lidera la optimización de procesos técnicos y mejora continua' },
                { nombre: 'Juan Daniel Jácome Yáñez', rol: 'Ingeniería de Planta', descripcion: 'Gestiona operaciones técnicas de recolección y tratamiento' },
                { nombre: 'Yosueth David Cárdenas Velasco', rol: 'Marketing y Ventas', descripcion: 'Estrategias comerciales y relación con clientes' },
                { nombre: 'Ruddy Rodríguez Romero', rol: 'Recursos Humanos', descripcion: 'Coordina talento humano y capacitación' },
                { nombre: 'Károlay Palafor Cantillo', rol: 'Operaciones de Campo', descripcion: 'Supervisa ejecución en terreno y logística' },
                { nombre: 'Kareylis González Cardona', rol: 'Educación Comunitaria', descripcion: 'Diseña programas de capacitación comunitaria' }
              ].map((miembro, idx) => (
                <div key={idx} className="bg-white rounded-xl p-6 shadow hover:shadow-xl transition">
                  <div className="w-16 h-16 bg-gradient-to-br from-blue-600 to-cyan-600 rounded-full mx-auto mb-4 flex items-center justify-center text-white font-bold">
                    {miembro.nombre.split(' ').map(n => n[0]).join('').slice(0,2)}
                  </div>
                  <h3 className="font-semibold text-gray-900 text-center">{miembro.nombre}</h3>
                  <p className="text-blue-600 text-center font-medium">{miembro.rol}</p>
                  <p className="text-sm text-gray-600 text-center mt-2">{miembro.descripcion}</p>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* Contacto */}
        <section id="contacto" className="py-16 px-4 sm:px-6 lg:px-8 bg-gradient-to-br from-blue-600 to-cyan-600 text-white">
          <div className="max-w-4xl mx-auto">
            <div className="text-center mb-8">
              <Mail className="w-14 h-14 mx-auto mb-4" />
              <h2 className="text-3xl md:text-4xl font-bold mb-2">¿Listo para Proteger tu Espacio?</h2>
              <p className="text-lg text-blue-100 max-w-2xl mx-auto">
                Solicita una evaluación y trabajemos juntos para reducir riesgos y aprovechar el agua de forma responsable.
              </p>
            </div>

            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-6 md:p-8">
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <form onSubmit={handleSubmit} className="space-y-4" noValidate>
                  <div>
                    <label className="block text-sm font-medium text-blue-100">Nombre</label>
                    <input
                      value={form.nombre}
                      onChange={(e) => setForm({...form, nombre: e.target.value})}
                      className="mt-1 block w-full rounded-md bg-white/90 text-gray-800 px-3 py-2"
                      aria-invalid={!!errors.nombre}
                    />
                    {errors.nombre && <p className="text-xs text-yellow-100 mt-1">{errors.nombre}</p>}
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-blue-100">Correo</label>
                    <input
                      value={form.email}
                      onChange={(e) => setForm({...form, email: e.target.value})}
                      className="mt-1 block w-full rounded-md bg-white/90 text-gray-800 px-3 py-2"
                      aria-invalid={!!errors.email}
                      type="email"
                    />
                    {errors.email && <p className="text-xs text-yellow-100 mt-1">{errors.email}</p>}
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-blue-100">Mensaje</label>
                    <textarea
                      value={form.mensaje}
                      onChange={(e) => setForm({...form, mensaje: e.target.value})}
                      
}
